webpackJsonp([22],{xYe0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("ZLEe"),n=a.n(s),l=a("4YfN"),o=a.n(l),i=a("R4Sj"),r=a("9cX3"),m=a("nXBt"),p=a("Ymoe"),c={computed:o()({},Object(i.e)({prom:function(e){return e.prom},user:function(e){return e.user}})),components:{"v-exportTable":r.a,"v-pageTable":p.a},data:function(){return{headers:{},tables:[],fileList:[],resultTable:{},resultTableName:[{tableName:"错误信息表"},{tableName:"核查结果表"}],oneTable:[],isloading:!1,tableName:""}},created:function(){console.log("bulkcm crate 函数"),sessionStorage.getItem("pname")&&this.setpname_prom(sessionStorage.getItem("pname")),window.addEventListener("beforeunload",function(){sessionStorage.setItem("pname",sessionStorage.getItem("pname"))}),this.headers={headers:{projectname:this.prom.prom_pname,username:JSON.parse(sessionStorage.user).username,filetype:"bulkcm"}},this.uploadHead={projectname:this.prom.prom_pname,username:JSON.parse(sessionStorage.user).username,filetype:"bulkcm",Authorization:"bearer "+sessionStorage.getItem("token")},this.uploadAction=this.user.httppath+"/api/Bulkcm/CheckUpload"},methods:o()({},Object(i.d)(["setpname_prom"]),{down:function(){var e=this.user.httppath+"/api/FileDown/Download",t={projectname:this.prom.prom_pname,username:JSON.parse(sessionStorage.user).username,filetype:"bulkcm"};Object(m.a)(e,t)},handleRemove:function(e,t){console.log("这是函数 handleRemove"),console.log(e),console.log(t)},handlePreview:function(e){console.log("这是函数 handlePreview"),console.log(e)},analysis:function(){var e=this;console.log("这是点击函数"),this.isloading=!0,this.$http.post(this.user.httppath+"/api/Bulkcm/ParamCheck",{},this.headers).then(function(t){"请上传核查文件"===t?(e.isloading=!1,e.$notify({title:"警告",message:"请上传核查文件",type:"warning"})):(e.resultTable=t,e.isloading=!1,e.$notify({title:"成功",message:"解析完成",type:"success"}))}).catch(function(t){e.$notify({title:"警告",message:t,type:"warning"})})},submitUpload:function(){this.$refs.upload.submit()},changeTableName:function(){0!==n()(this.resultTable).length&&("错误信息表"===this.tableName?this.oneTable=this.resultTable["错误信息表"]:this.oneTable=this.resultTable["核查结果表"])}})},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-main",[a("br"),e._v(" "),a("el-upload",{ref:"upload",staticClass:"elmro",attrs:{action:e.uploadAction,headers:e.uploadHead,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!1,limit:1,multiple:!0,accept:".csv,"}},[a("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[e._v("选取核查表")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持.csv格式的文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"success"},on:{click:e.submitUpload}},[e._v("上传到服务器")]),e._v(" "),a("a",{on:{click:e.down}},[e._v("模板下载 ")])],1),e._v(" "),a("br"),e._v(" "),a("hr"),e._v(" "),a("el-button",{staticStyle:{width:"80px","margin-left":"2px"},attrs:{type:"primary",loading:e.isloading,size:"mini"},on:{click:e.analysis}},[e._v("解析")]),e._v(" "),a("v-exportTable",{attrs:{tableData:e.oneTable}}),e._v(" "),a("el-form",{staticClass:"demo-form-inline",staticStyle:{"margin-top":"10px"},attrs:{inline:!0}},[a("el-form-item",{staticStyle:{"margin-bottom":"10px"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"表名称"},on:{change:e.changeTableName},model:{value:e.tableName,callback:function(t){e.tableName=t},expression:"tableName"}},e._l(e.resultTableName,function(t){return a("el-option",{key:t.tableName,attrs:{label:t.tableName,value:t.tableName}},[e._v(e._s(t.tableName))])}),1)],1)],1),e._v(" "),a("v-pageTable",{attrs:{tableData:e.oneTable}})],1)],1)},staticRenderFns:[]},b=a("C7Lr")(c,u,!1,null,null,null);t.default=b.exports}});
//# sourceMappingURL=22.b19280ebd9b0bd58d62d.js.map